"use strict";(self.webpackChunkeducation_docs=self.webpackChunkeducation_docs||[]).push([[3552],{1282:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var n=i(4848),r=i(8453);const s={},o="EIP-1559",a={id:"courses/blockchain-developer-bootcamp/S02-ethereum/M3-state/L7-1559/index",title:"EIP-1559",description:"We've talked about mining in the Ethereum as the way the network confirms and propagates state changes. However, in August 2021, the Ethereum core developer community, after many years of research, development and testing, released a major change to the mining process in Ethereum known as EIP-1559 (remember Ethereum Improvement Proposals or EIPs are the way the Ethereum community incorporates changes to the protocol).",source:"@site/docs/courses/blockchain-developer-bootcamp/S02-ethereum/M3-state/L7-1559/index.md",sourceDirName:"courses/blockchain-developer-bootcamp/S02-ethereum/M3-state/L7-1559",slug:"/courses/blockchain-developer-bootcamp/S02-ethereum/M3-state/L7-1559/",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S02-ethereum/M3-state/L7-1559/",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"oliver renwick",lastUpdatedAt:1721055769e3,frontMatter:{},sidebar:"docSidebar",previous:{title:"Playing with Merkle Trees",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S02-ethereum/M3-state/L6-playing-with-merkle-trees/"},next:{title:"Merkel Trees",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S02-ethereum/M3-state/L8-networks/"}},c={},l=[{value:"Changes for Developers",id:"changes-for-developers",level:2},{value:"Blocks",id:"blocks",level:3},{value:"Transaction Data",id:"transaction-data",level:3},{value:"Transaction Simulation",id:"transaction-simulation",level:3},{value:"Additional Material",id:"additional-material",level:2},{value:"Technical",id:"technical",level:3}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"eip-1559",children:"EIP-1559"}),"\n",(0,n.jsxs)(t.p,{children:["We've talked about mining in the Ethereum as the way the network confirms and propagates state changes. However, in August 2021, the Ethereum core developer community, after many years of research, development and testing, released a major change to the mining process in Ethereum known as ",(0,n.jsx)(t.a,{href:"https://eips.ethereum.org/EIPS/eip-1559",children:"EIP-1559"})," (remember Ethereum Improvement Proposals or EIPs are the way the Ethereum community incorporates changes to the protocol)."]}),"\n",(0,n.jsx)(t.p,{children:"Before EIP-1559, Ethereum transaction fees were market-driven. Meaning, the gas price, or fee, dictated how quickly a miner would include a transaction in a block. This has led to some dramatic price swings in fees and pushed network developers to find a more stable solution. Enter EIP-1559."}),"\n",(0,n.jsx)(t.p,{children:'EIP-1559 replaces the gas fees with a fixed-price sale. Now, people submitting transactions won\u2019t have to guess as much about how much gas is required, as there will be an explicitly \u2018base fee\u2019 to be included in the next block. For users or applications that want to prioritize their transaction, they can add a \u201ctip\u201d to pay a miner. The base fee will be "burned," meaning destroyed, while the tip goes to the miner.'}),"\n",(0,n.jsx)(t.p,{children:"In times of high network activity, the base fee will adjust in a predictable manner to gate the flow of transactions."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"diagram showing before and after 1559 of network processing transactions",src:i(2454).A+"",width:"1600",height:"898"})}),"\n",(0,n.jsx)(t.p,{children:"As an analogy to explain the base fee and tip, imagine the experience of using a ride sharing service app on your phone (e.g. Uber, Lyft, or Didi). You want to use this app to get a ride to go from A to B. The cost to go from A to B is the same, regardless of which driver picks you up (the base fee in EIP-1559). Now, imagine if you were able to add a tip to your driver, prior to getting on the ride. If your tip is higher than what other people at that time are offering, drivers will be incentivized to pick you up over other potential passengers not offering a tip."}),"\n",(0,n.jsx)(t.p,{children:"This process is similar to your ETH transactions: you can set a tip for miners (the \u201cdriver\u201d in the above example) to include your transaction in the next block (the \u201cride\u201d in the above example). A higher tip means a greater chance of your transaction being included in the next block and therefore being completed."}),"\n",(0,n.jsxs)(t.p,{children:["Crucially, EIP-1559 makes the gas prices more transparent but it does ",(0,n.jsx)(t.strong,{children:"not"})," lower the prices. This is a common misconception. EIP-1559 may reduce the amount of time the network has high gas prices, but the only way to deal with high gas prices is to improve scalability (which we'll discuss in a later section)."]}),"\n",(0,n.jsx)(t.p,{children:"It's still very early days for 1559 and we'll get to see how it progresses together!"}),"\n",(0,n.jsx)(t.h2,{id:"changes-for-developers",children:"Changes for Developers"}),"\n",(0,n.jsx)(t.p,{children:"EIP-1559 is a backwards compatible upgrade. You'll remember from the section on distributed consensus, this means that pre-EIP-1559 transaction structure is still supported. However, post-EIP-1559, a transaction price is calculated using the following equation:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"transaction fee = baseFee + min(maxFee - baseFee, priorityFee)\n"})}),"\n",(0,n.jsx)(t.p,{children:"An explanation of the three variables:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"baseFee"})," A fee that floats based on the network congestion and the most recent value can be fetched via a new JSON RPC call ",(0,n.jsx)(t.code,{children:"eth_feeHistory"})]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"priorityFee"})," (also called a tip) A fee to entice a block producer to include the transaction."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"maxFee"})})," The highest network fee the user is willing to pay."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["Here are some changes to the ",(0,n.jsx)(t.a,{href:"https://eth.wiki/json-rpc/API",children:"Ethereum JSON-RPC format"})," you will see on the protocol level that may affect the way you develop as well, broken down by part of the Ethereum protocol affected:"]}),"\n",(0,n.jsx)(t.h3,{id:"blocks",children:"Blocks"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"eth_getBlockBy"})," A new field baseFeePerGas is included for post-London blocks"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"eth_getUncleBy*"})," A new field baseFeePerGas is included for post-London blocks"]}),"\n",(0,n.jsxs)(t.li,{children:["Block header data ",(0,n.jsx)(t.code,{children:"baseFeePerGas"})," is the base fee paid by all transactions in this block. (The field is empty for all blocks before the fork.)"]}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"transaction-data",children:"Transaction Data"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"maxPriorityFeePerGas"})," specifies the tip (priority fee) to entice a block producer to include your transaction."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"maxFeePerGas"})," is the maximum fee the user is willing to pay the block producer for including this transaction."]}),"\n",(0,n.jsxs)(t.li,{children:["Legacy transactions that only include a ",(0,n.jsx)(t.code,{children:"gasPrice"})," are still valid and they will be accepted into the blocks. The user will simply pay the entire proposed network fee and as a result they may pay a premium compared to other users on the network."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"eth_gasPrice"})," is deprecated and replaced with ",(0,n.jsx)(t.code,{children:"eth_feeHistory"}),", which returns transaction fee data for up to 1024 blocks. For each block, ",(0,n.jsx)(t.code,{children:"eth_feeHistory"})," reports the base fee, a percentile list of effective priority fees and the ratio of gas used/limit. Note the required base fee for the next block is returned as well."]}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"transaction-simulation",children:"Transaction Simulation"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"eth_call"})," May require the developer to specify the gas price or new 1559 gas pricing to reflect true execution of a transaction. The Go-Ethereum (geth) developer team has more about the changes to ",(0,n.jsx)(t.code,{children:"eth_call"})," ",(0,n.jsx)(t.a,{href:"https://github.com/ethereum/go-ethereum/pull/23027",children:"here."})]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"eth_estimateGas"})," May fail to estimate the gas if the gas price or new 1559 gas pricing is not filled in (i.e., greater than 0)."]}),"\n",(0,n.jsxs)(t.li,{children:["London Fork, which implements EIP-1559, also implements the related EIP-3198. This adds a new opcode, ",(0,n.jsx)(t.code,{children:"BASEFEE"}),", that returns the base fee of the current block it is executing in. It is recommended for developers to explicitly set the gas pricing for both JSON RPC calls to avoid a failed JSON RPC call response."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"additional-material",children:"Additional Material"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://youtu.be/MGemhK9t44Q",children:"Video: EIP-1559 Explained (Finematics)"})}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://consensys.net/blog/quorum/what-is-eip-1559-how-will-it-change-ethereum/",children:"Article: What is EIP-1559? (ConsenSys)"})," A great introductory explainer article we used for much of the course material."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://metamask.io/1559",children:"Article: What is EIP-1559? (MetaMask)"})," Another introductory article, this time from the perspective of a MetaMask user"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://www.youtube.com/watch?v=gsfJywNxpi4",children:"Video: How To Set Transaction Priority in MetaMask"})," Great video walking through the ways in which MetaMask is adjusting to EIP-1559."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://ultrasound.money/",children:"Interactive: Ultrasound Money"})," The website provides realtime updates on how much ether has been burned as part of EIP-1559"]}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"technical",children:"Technical"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://blog.infura.io/london-fork/",children:"Article: London Fork (Infura)"})," Great technical overview of the protocol changes coming to clients, specifically to the JSON-RPC API calls all Ethereum clients must use."]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://hackmd.io/@timbeiko/1559-json-rpc",children:"Article: EIP-1559 JSON-RPC Changes (Tim Beiko)"})," A more dry look at the JSON-RPC changes"]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://hackmd.io/@timbeiko/1559-resources",children:"Wiki: 1559 Resources (Tim Beiko)"})," A comprehensive list of resources to explore any aspect of EIP-1559, from the UX, Security, Economics, Mining or Simulations"]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://github.com/ethereum/go-ethereum/pull/23027",children:"GitHub: eth_call invocations post 1559"})," Explainer from the Geth team about the changes to the ",(0,n.jsx)(t.code,{children:"eth_call"})," JSON-RPC call"]}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},2454:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/1559-828748ac300af21816ce64de93e62520.png"},8453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>a});var n=i(6540);const r={},s=n.createContext(r);function o(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);