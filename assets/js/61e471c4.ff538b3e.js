"use strict";(self.webpackChunkeducation_docs=self.webpackChunkeducation_docs||[]).push([[4642],{8154:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var i=t(4848),r=t(8453);const a={},o=void 0,s={id:"courses/blockchain-developer-bootcamp/S04-developer-tooling/M3-infura/L2/index",title:"index",description:"Using Infura to Access Ethereum Archive Data (Tutorial)",source:"@site/docs/courses/blockchain-developer-bootcamp/S04-developer-tooling/M3-infura/L2/index.md",sourceDirName:"courses/blockchain-developer-bootcamp/S04-developer-tooling/M3-infura/L2",slug:"/courses/blockchain-developer-bootcamp/S04-developer-tooling/M3-infura/L2/",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S04-developer-tooling/M3-infura/L2/",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"oliver renwick",lastUpdatedAt:1721055769e3,frontMatter:{},sidebar:"docSidebar",previous:{title:"index",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S04-developer-tooling/M3-infura/L1/"},next:{title:"Testing, 1, 2, 3",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S04-developer-tooling/M4-truffle-deep-dive/L1-truffle-tests/"}},c={},l=[{value:"Using Infura to Access Ethereum Archive Data (Tutorial)",id:"using-infura-to-access-ethereum-archive-data-tutorial",level:2},{value:"Setup and Configuration",id:"setup-and-configuration",level:3},{value:"The Front-end",id:"the-front-end",level:4}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"using-infura-to-access-ethereum-archive-data-tutorial",children:"Using Infura to Access Ethereum Archive Data (Tutorial)"}),"\n",(0,i.jsx)(n.p,{children:"This is a full-stack application that provides a reference implementation and proof-of-concept for\nvarious use cases that are enabled by access to Ethereum archive data."}),"\n",(0,i.jsxs)(n.p,{children:["Check out the repo here:  ",(0,i.jsx)(n.a,{href:"https://github.com/anataliocs/Archive-Data-Playground",children:"https://github.com/anataliocs/Archive-Data-Playground"})]}),"\n",(0,i.jsx)(n.p,{children:"Technologies Used:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Java 11"}),"\n",(0,i.jsx)(n.li,{children:"Spring Boot"}),"\n",(0,i.jsx)(n.li,{children:"Gradle"}),"\n",(0,i.jsx)(n.li,{children:"Typescript"}),"\n",(0,i.jsx)(n.li,{children:"React/Redux"}),"\n",(0,i.jsx)(n.li,{children:"node/npm"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"setup-and-configuration",children:"Setup and Configuration"}),"\n",(0,i.jsx)(n.p,{children:"The project is built with a Java/Spring Boot backend and a React front-end.\nYou will need to install the following dependencies locally to run this project:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://infura.io/register",children:"An Infura account"})}),"\n",(0,i.jsx)(n.li,{children:"Git"}),"\n",(0,i.jsx)(n.li,{children:"Node / npm"}),"\n",(0,i.jsx)(n.li,{children:"Java 11"}),"\n",(0,i.jsx)(n.li,{children:"An IDE"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Get your API endpoint URL and Project ID"})}),"\n",(0,i.jsxs)(n.p,{children:["Head to ",(0,i.jsx)(n.a,{href:"https://infura.io/",children:"https://infura.io/"})," and go to your project settings page:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/anataliocs/Archive-Data-Playground/main/static/Infura-ui.jpeg",alt:"Infura Dashboard"})}),"\n",(0,i.jsxs)(n.p,{children:["Now let\u2019s set up our externalized configuration so that we can use our project ID without exposing those details on Github.\nThe Spring Boot app uses Spring Dev Tools when running locally so we can use a ",(0,i.jsx)(n.code,{children:".spring-boot-devtools.properties"})," file for\nconfiguration properties."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Configuration for MacOS users:"})}),"\n",(0,i.jsx)(n.p,{children:"Create the properties file:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"touch ~/.spring-boot-devtools.properties"})}),"\n",(0,i.jsx)(n.p,{children:"Open the properties file:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"vi ~/.spring-boot-devtools.properties"})}),"\n",(0,i.jsx)(n.p,{children:"Add the following line to properties file:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"infura.projectid=[YOUR_PROJECT_ID]"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Running the application:"})}),"\n",(0,i.jsx)(n.p,{children:"Pull down the source code:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"git clone git@github.com:anataliocs/Archive-Data-Playground.git"})}),"\n",(0,i.jsx)(n.p,{children:"Import the project into your IDE and it should build automatically.\nOur project uses gradle to build the back-end and npm/webpack for the front-end UI."}),"\n",(0,i.jsx)(n.p,{children:"Change directory into the project folder:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"cd archivedataplayground/"})}),"\n",(0,i.jsx)(n.p,{children:"Then to run the full stack, invoke the Gradle wrapper:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"./gradlew"})}),"\n",(0,i.jsx)(n.p,{children:"This command will start up the Spring Boot backend in dev mode and also the React front-end all in one command!"}),"\n",(0,i.jsx)(n.p,{children:"After the application starts up you should see the following:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"2022-05-31 11:21:45.262  INFO 83493 --- [  restartedMain] i.i.a.ArchiveDataPlaygroundApp           : Started ArchiveDataPlaygroundApp in 3.709 seconds (JVM running for 3.924)\n2022-05-31 11:21:45.264  INFO 83493 --- [  restartedMain] i.i.a.ArchiveDataPlaygroundApp           :\n----------------------------------------------------------\n        Application 'archivedataplayground' is running! Access URLs:\n        Local:          http://localhost:8080/\n        External:       http://192.168.0.37:8080/\n        Profile(s):     [dev, api-docs]\n----------------------------------------------------------\n<============-> 92% EXECUTING [2m 15s]\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Navigate to the local server in a browser at ",(0,i.jsx)(n.a,{href:"http://localhost:8080/",children:"http://localhost:8080/"}),"\n",(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/anataliocs/Archive-Data-Playground/main/static/app-UI-1.png",alt:"App UI"})]}),"\n",(0,i.jsxs)(n.p,{children:["On the right-hand corner click account -> Sign-in and use the canned login and password \u201cadmin/admin\u201d\n",(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/anataliocs/Archive-Data-Playground/main/static/app-ui-2.png",alt:"App UI"})]}),"\n",(0,i.jsx)(n.p,{children:"You will then have access to the application.  The login flow comes from the base Jhipster project scaffolding tool that\nwas used to create the basic project skeleton."}),"\n",(0,i.jsxs)(n.p,{children:["You can directly query Infura JSON-RPC endpoints if you navigate to\n",(0,i.jsx)(n.a,{href:"http://localhost:8080/admin/docs",children:"http://localhost:8080/admin/docs"})," or click Administration -> API"]}),"\n",(0,i.jsx)(n.p,{children:"This will bring you to the Swagger UI interface where you can call JSON-RPC endpoints such as getting blocks older than\n128 blocks which are available via Archive nodes with hydrated transactions.  These calls can then be used in Block Explorer style\napplications or other use cases."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/anataliocs/Archive-Data-Playground/main/static/swagger-ui-1.png",alt:"Swagger UI"})}),"\n",(0,i.jsx)(n.p,{children:"Some specific blocks of code that help enable this functionality include:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/anataliocs/Archive-Data-Playground/blob/main/src/main/java/io/infura/archivedataplayground/config/InfuraConfig.java",children:"https://github.com/anataliocs/Archive-Data-Playground/blob/main/src/main/java/io/infura/archivedataplayground/config/InfuraConfig.java"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"InfuraConfig.java"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"@Configuration\npublic class InfuraConfig {\n\n   @Bean\n   public RestTemplate restTemplate() {\n      return new RestTemplate();\n   }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"This code provides a \u201cRestTemplate\u201d singleton which can be injected in classes where it\u2019s needed and helps abstract away the complexity of making JSON-RPC calls to Infura."}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"dto.infura"})," package contains POJO objects representing request and response JSONs used in Infura RPC calls."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/anataliocs/Archive-Data-Playground/tree/main/src/main/java/io/infura/archivedataplayground/service/dto/infura",children:"https://github.com/anataliocs/Archive-Data-Playground/tree/main/src/main/java/io/infura/archivedataplayground/service/dto/infura"})}),"\n",(0,i.jsxs)(n.p,{children:["For instance, the following 3 DTO objects contain the block and hydrated transactions response from\nan ",(0,i.jsx)(n.code,{children:"eth_getBlockByNumber"})," JSON-RPC call which can be used to get archive blocks from Ethereum\u2019s history."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"GetBlockByNumberResponse.java"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"public class GetBlockByNumberResponse {\n   private String jsonrpc;\n   private String id;\n   private GetBlockByNumberResult result;\n\n   // Getters and setters\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Infura POJO response to de-serialize JSON"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"GetBlockByNumberResult.java"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"public class GetBlockByNumberResult {\n   private String difficulty;\n   private String extraData;\n   private String gasLimit;\n   private String gasUsed;\n   private String hash;\n   private String logsBloom;\n   private String miner;\n   private String mixHash;\n   private String nonce;\n   private String number;\n   private String parentHash;\n   private String receiptsRoot;\n   private String sha3Uncles;\n   private String size;\n   private String stateRoot;\n   private String timestamp;\n   private String totalDifficulty;\n   private Transaction[] transactions; //Hydrated Transactions\n\n   // Getters and setters\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Infura POJO response to de-serialize JSON"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Transaction.java"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"public class Transaction {\n\n   private String blockHash;\n   private String blockNumber;\n   private String from;\n   private String gas;\n   private String gasPrice;\n   private String hash;\n   private String input;\n   private String nonce;\n   private String r;\n   private String s;\n   private String to;\n   private String transactionIndex;\n   private String type;\n   private String v;\n   private String value;\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"The included \u201cRestTemplate\u201d will automatically marshal/unmarshal responses into these Object types."}),"\n",(0,i.jsxs)(n.p,{children:["You could also consider using ",(0,i.jsx)(n.a,{href:"https://github.com/web3j/web3j",children:"https://github.com/web3j/web3j"})," to help facilitate Infura JSON\u2013RPC calls made using the Spring Boot\nbackend but this is a more heavyweight solution that contains a lot of stuff you might not need."]}),"\n",(0,i.jsx)(n.h4,{id:"the-front-end",children:"The Front-end"}),"\n",(0,i.jsx)(n.p,{children:"One feature that archive data enables is Block Exploration."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/anataliocs/Archive-Data-Playground/main/static/app-ui-3.png",alt:"Swagger UI"})}),"\n",(0,i.jsx)(n.p,{children:"This block explorer displays information about about famous blocks in Ethereum history such as:"}),"\n",(0,i.jsx)(n.p,{children:"Frontier"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Block height: 0"}),"\n",(0,i.jsx)(n.li,{children:"Genesis block"}),"\n",(0,i.jsx)(n.li,{children:"Jul 30 2015"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Frontier Thawing"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Block height: 200000"}),"\n",(0,i.jsx)(n.li,{children:"Ethereum price: $1.24 USD"}),"\n",(0,i.jsx)(n.li,{children:"Sep 07 2015"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Homestead"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Block height: 1,150,000"}),"\n",(0,i.jsx)(n.li,{children:"Ethereum price: $12.50 USD"}),"\n",(0,i.jsx)(n.li,{children:"Mar 14 2016"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The front-end is implemented using React and Typescript.  This form allows you to submit a block number and look up that block\u2019s data\nand hydrated transactions."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"infura.tsx"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\u2026\n\n<p className="lead">Explore historical Ethereum Data</p>\n<Form onSubmit={handleBlockByNumberSubmit}>\n\n   <ValidatedField\n   name="blockNumber"\n   label="Block Number"\n   placeholder="Block Number in hex"\n   required\n   autoFocus\n   data-cy="blockNumber"\n   validate={{required: \'Block Number cannot be empty!\'}}\n   error={errors.blockNumber}\n   isTouched={touchedFields.blockNumber}\n   />\n\n   <Button color="primary" type="submit" data-cy="submit">\n     Search\n   </Button><br/>\n</Form>\n\n\u2026\n'})}),"\n",(0,i.jsx)(n.p,{children:"Submitting the form dispatches a request to the Spring Boot API and uses a reducer to parse the JSON returned from the backend and stores\nthat state in Redux."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"infura.reducer.tsx"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u2026\n\nexport const getInfura = createAsyncThunk('infura/get_json', async (blocknumber: string) => axios.get<any>(`api/infura/${blocknumber}`), {\nserializeError: serializeAxiosError,\n});\n\n\u2026\n"})}),"\n",(0,i.jsx)(n.p,{children:"This is only a simple example of functionality that access to archive data enables.  Using this basic framework, you could create\nEthereum block analytics, more detailed Block Explorers, back testing for trading algorithms and Blockchain forensics applications!"})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>s});var i=t(6540);const r={},a=i.createContext(r);function o(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);