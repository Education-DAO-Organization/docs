"use strict";(self.webpackChunkeducation_docs=self.webpackChunkeducation_docs||[]).push([[5683],{7497:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var i=t(4848),o=t(8453);const a={},s="Filecoin",l={id:"courses/blockchain-developer-bootcamp/S07-additional-topics/L2-filecoin/index",title:"Filecoin",description:"Protocol Labs, who built IPFS, have developed an entire network for decentralized filesharing called Filecoin. In this section, we'll go through a Truffle Box which sets up a Filecoin environment on your computer.",source:"@site/docs/courses/blockchain-developer-bootcamp/S07-additional-topics/L2-filecoin/index.md",sourceDirName:"courses/blockchain-developer-bootcamp/S07-additional-topics/L2-filecoin",slug:"/courses/blockchain-developer-bootcamp/S07-additional-topics/L2-filecoin/",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S07-additional-topics/L2-filecoin/",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"oliver renwick",lastUpdatedAt:1721055769e3,frontMatter:{},sidebar:"docSidebar",previous:{title:"index",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S07-additional-topics/L1-ipfs/"},next:{title:"The Graph",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S07-additional-topics/L3-the-graph/"}},r={},c=[{value:"Using the Filecoin Truffle Box",id:"using-the-filecoin-truffle-box",level:2},{value:"Environment Setup",id:"environment-setup",level:2},{value:"Running Filecoin-flavored Ganache",id:"running-filecoin-flavored-ganache",level:3},{value:"Running the Filecoin Network Explorer",id:"running-the-filecoin-network-explorer",level:3},{value:"Running Ethereum Ganache",id:"running-ethereum-ganache",level:3},{value:"Creating Storage Deals",id:"creating-storage-deals",level:2},{value:"Minting an NFT",id:"minting-an-nft",level:2},{value:"Gallery UI",id:"gallery-ui",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"filecoin",children:"Filecoin"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://protocol.ai/",children:"Protocol Labs"}),", who built ",(0,i.jsx)(n.a,{href:"https://ipfs.tech/",children:"IPFS"}),", have developed an entire network for decentralized filesharing called Filecoin. In this section, we'll go through a ",(0,i.jsx)(n.a,{href:"https://trufflesuite.com/boxes/",children:"Truffle Box"})," which sets up a Filecoin environment on your computer."]}),"\n",(0,i.jsxs)(n.p,{children:["The context of the box is that of a decentralized art gallery. It comprises both Lotus and IPFS nodes (simulating the process of creating a storage deal), an Ethereum node (for the deployment of the ",(0,i.jsx)(n.a,{href:"https://docs.openzeppelin.com/contracts/4.x/",children:"OpenZeppelin-based ERC-721"})," based NFT contracts) and a front-end for viewing the gallery and the decentrally stored assets."]}),"\n",(0,i.jsx)(n.h2,{id:"using-the-filecoin-truffle-box",children:"Using the Filecoin Truffle Box"}),"\n",(0,i.jsx)(n.p,{children:"This guide uses an pre-existing project to provide the base Truffle project structure and example contracts.\nIn your workspace directory, run the following commands:"}),"\n",(0,i.jsx)(n.p,{children:"mkdir filecoin-example\ncd filecoin-example\ntruffle unbox filecoin"}),"\n",(0,i.jsx)(n.h2,{id:"environment-setup",children:"Environment Setup"}),"\n",(0,i.jsx)(n.p,{children:"The following steps guide you through getting the Filecoin environment set up on your computer."}),"\n",(0,i.jsx)(n.h3,{id:"running-filecoin-flavored-ganache",children:"Running Filecoin-flavored Ganache"}),"\n",(0,i.jsxs)(n.p,{children:["The easiest way to run a Filecoin environment locally is via ",(0,i.jsx)(n.a,{href:"https://github.com/trufflesuite/ganache-ui/releases/tag/v2.6.0-beta.3",children:"Filecoin-flavored Ganache"})," (which runs both a local IPFS and Lotus node). To download, select the appropriate build for your OS from the ",(0,i.jsx)(n.strong,{children:"Assets"})," list at the bottom of the ",(0,i.jsx)(n.a,{href:"https://github.com/trufflesuite/ganache-ui/releases/tag/v2.6.0-beta.3#user-content-2.6.0-beta.3-How-to-Upgrade",children:"release page"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"This creates 10 accounts, each loaded with 100 FIL, and displays both their account addresses and associated private keys (which can be accessed by clicking on the key icon on the right-hand side)."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Ganache GUI",src:t(5491).A+"",width:"2386",height:"1594"})}),"\n",(0,i.jsxs)(n.p,{children:["It also starts the Lotus and IPFS daemons running over ",(0,i.jsx)(n.code,{children:"http"})," and ",(0,i.jsx)(n.code,{children:"ws"})," respectively:"]}),"\n",(0,i.jsx)(n.p,{children:"Lotus RPC listening on 127.0.0.1:7777\nIPFS  RPC listening on 127.0.0.1:5001"}),"\n",(0,i.jsx)(n.h3,{id:"running-the-filecoin-network-explorer",children:"Running the Filecoin Network Explorer"}),"\n",(0,i.jsx)(n.p,{children:"The folloing steps guide you through setting up Filecoin Network Innspector utility which enables you to upload files to the IPFS node and create a Filecoin storage deal."}),"\n",(0,i.jsxs)(n.p,{children:["git clone ",(0,i.jsx)(n.a,{href:"https://github.com/trufflesuite/filecoin-network-inspector",children:"https://github.com/trufflesuite/filecoin-network-inspector"}),"\ncd filecoin-network-inspector\ngit checkout ganache-changes\nnpm install\nnpm run start"]}),"\n",(0,i.jsx)(n.h3,{id:"running-ethereum-ganache",children:"Running Ethereum Ganache"}),"\n",(0,i.jsxs)(n.p,{children:["The following command starts a local ",(0,i.jsx)(n.a,{href:"https://trufflesuite.com/ganache/",children:"Ganache"})," instance that we'll be deploying our smart contracts to:"]}),"\n",(0,i.jsx)(n.p,{children:"npx ganache"}),"\n",(0,i.jsx)(n.p,{children:"Awesome! All going well you've now got your environment setup and ready to simulate creating your first storage deal."}),"\n",(0,i.jsx)(n.h2,{id:"creating-storage-deals",children:"Creating Storage Deals"}),"\n",(0,i.jsx)(n.p,{children:"A storage deal is an agreement between a client and a storage miner to store some data in the network for a given duration. Note that while in the case of Filecoin's mainnet, a deal must be secured with a miner before data is stored, in Filecoin Ganache a deal is reached automatically. Via the Filecoin Network Explorer:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:'Open the Filecoin Network Explorer and navigate to the "Market" tab'}),"\n",(0,i.jsx)(n.li,{children:'Select a file by clicking "Choose File" followed by "Upload to the Filecoin Network"'}),"\n",(0,i.jsxs)(n.li,{children:["Optionally add all the files from the ",(0,i.jsx)(n.code,{children:"/assets"})," directory (note that these are already on IPFS so the application still work if you don't do this step)"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["As you add files, if you open Ganache, you should see both the files themselves (under the Files tab) and the accompanying storage deals (under the Deals tab) show up. This is of course just a simulation of the process, but it's a good way to get a feel for how it works. More information on storage and retrieval deals can be found in the ",(0,i.jsx)(n.a,{href:"https://filecoin.io/blog/posts/how-storage-and-retrieval-deals-work-on-filecoin/",children:"Filecoin Docs"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"minting-an-nft",children:"Minting an NFT"}),"\n",(0,i.jsx)(n.p,{children:"In the example below, we've already created a deal for the 3 assets (metadata, thumbnail, and the original asset respectively) that comprise our NFT. These are as follows, with their corresponding CIDs."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["metadata ",(0,i.jsx)(n.a,{href:"https://ipfs.io/ipfs/QmUWFZQrJHfCVNHXVjjb2zeowVvH7dC6rKpbdHsTdnAgvP",children:"QmS4t7rFPxaaNriXvCmALr5GYRAtya5urrDaZgkfHutdCG"})]}),"\n",(0,i.jsxs)(n.li,{children:["thumbnail ",(0,i.jsx)(n.a,{href:"https://ipfs.io/ipfs/QmbAAMaGWpiSgmMWYTRtGsru382j6qTVQ4FDKX2cRTRso6",children:"QmbAAMaGWpiSgmMWYTRtGsru382j6qTVQ4FDKX2cRTRso6"})]}),"\n",(0,i.jsxs)(n.li,{children:["asset - ",(0,i.jsx)(n.a,{href:"https://ipfs.io/ipfs/QmS4t7rFPxaaNriXvCmALr5GYRAtya5urrDaZgkfHutdCG",children:"QmbAAMaGWpiSgmMWYTRtGsru382j6qTVQ4FDKX2cRTRso6"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Assuming the local Ethereum Ganache node is running, you'll be able to open a console and mint a new NFT with the following steps. As the base URL is set to that of an IPFS gateway, we'll just need to pass in the CID to the asset metadata."}),"\n",(0,i.jsx)(n.p,{children:'truffle migrate\ntruffle console\ntruffle(development)> const gallery = await MyGallery.deployed()\ntruffle(development)> gallery.mint(accounts[0], "QmS4t7rFPxaaNriXvCmALr5GYRAtya5urrDaZgkfHutdCG")'}),"\n",(0,i.jsxs)(n.p,{children:["In the above example the owner of the NFT is set (via ",(0,i.jsx)(n.code,{children:"accounts[0]"}),") to that of the first account generated by the mnemonic. If we want to transfer it to a new owner, we'll be able to do so with the following.\nTransferring Ownership"]}),"\n",(0,i.jsx)(n.p,{children:"truffle console\ntruffle(development)> gallery.transferFrom(accounts[0], accounts[1], 1)"}),"\n",(0,i.jsx)(n.h2,{id:"gallery-ui",children:"Gallery UI"}),"\n",(0,i.jsx)(n.p,{children:"A sample gallery interface is provided as a means of viewing all the assets (and their associated deals) you've just uploaded. Use the following steps to run this locally:"}),"\n",(0,i.jsx)(n.p,{children:"cd ui\nnpm install\nnpm run start"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Ganache GUI",src:t(1302).A+"",width:"2752",height:"2012"})}),"\n",(0,i.jsxs)(n.p,{children:["All going well, you should now be able to view the gallery at ",(0,i.jsx)(n.a,{href:"http://localhost:3000/",children:"http://localhost:3000"}),"."]})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},1302:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/gallery-1-22fe45919b4312fed0e0b5381bc396e6.png"},5491:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/ganache-1-65de84abd45b9814ab8c7061757eeef2.png"},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>l});var i=t(6540);const o={},a=i.createContext(o);function s(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);