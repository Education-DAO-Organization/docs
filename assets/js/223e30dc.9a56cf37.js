"use strict";(self.webpackChunkeducation_docs=self.webpackChunkeducation_docs||[]).push([[6941],{8423:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>l,frontMatter:()=>o,metadata:()=>r,toc:()=>h});var a=n(4848),s=n(8453);const o={},i="Web 3 JavaScript Libraries",r={id:"courses/blockchain-developer-bootcamp/S04-developer-tooling/M2-web3-libraries/L1-intro-web3-ethers/index",title:"Web 3 JavaScript Libraries",description:'As we mentioned in "Where Do Users Fit in Our Mental Model?" Web 3 JavaScript APIs are critical to connecting users to our blockchain applications. There are a variety of common JavaScript libraries that you can use to connect to Ethereum and develop an interface for your users. Many of the libraries serve the same purpose and have the same functionality, but the syntax differs for each.',source:"@site/docs/courses/blockchain-developer-bootcamp/S04-developer-tooling/M2-web3-libraries/L1-intro-web3-ethers/index.md",sourceDirName:"courses/blockchain-developer-bootcamp/S04-developer-tooling/M2-web3-libraries/L1-intro-web3-ethers",slug:"/courses/blockchain-developer-bootcamp/S04-developer-tooling/M2-web3-libraries/L1-intro-web3-ethers/",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S04-developer-tooling/M2-web3-libraries/L1-intro-web3-ethers/",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"oliver renwick",lastUpdatedAt:1721061896e3,frontMatter:{},sidebar:"docSidebar",previous:{title:"Blockchain Agnostic Developer Workflow",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S04-developer-tooling/M1-intro/L4-ag-dev-workflow/"},next:{title:"index",permalink:"/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S04-developer-tooling/M2-web3-libraries/L2-web3-connect-to-contract/"}},c={},h=[{value:"Truffle",id:"truffle",level:2},{value:"Web3.js",id:"web3js",level:2},{value:"Connect to Ganache GUI",id:"connect-to-ganache-gui",level:2},{value:"Import Ganache Account into MetaMask",id:"import-ganache-account-into-metamask",level:2},{value:"Sending the Transaction",id:"sending-the-transaction",level:2},{value:"Checking the account",id:"checking-the-account",level:3},{value:"Sending a Transaction",id:"sending-a-transaction",level:3}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h1,{id:"web-3-javascript-libraries",children:"Web 3 JavaScript Libraries"}),"\n",(0,a.jsx)(t.p,{children:'As we mentioned in "Where Do Users Fit in Our Mental Model?" Web 3 JavaScript APIs are critical to connecting users to our blockchain applications. There are a variety of common JavaScript libraries that you can use to connect to Ethereum and develop an interface for your users. Many of the libraries serve the same purpose and have the same functionality, but the syntax differs for each.'}),"\n",(0,a.jsxs)(t.p,{children:["The purpose of this lesson is to show the similarities and differences between the main two libraries,",(0,a.jsx)(t.a,{href:"https://web3js.readthedocs.io/en/latest/",children:" Web3.js"})," and ",(0,a.jsx)(t.a,{href:"https://docs.ethers.io/v5/",children:"ethers.js,"})," so you gain a better understanding of what these libraries do a general level and how each one does it."]}),"\n",(0,a.jsx)(t.p,{children:"If you are using the Brave browser, you may encounter conflicts with the built-in Ethereum wallet and Metamask. If this happens, try using a different browser with Metamask installed."}),"\n",(0,a.jsx)(t.h2,{id:"truffle",children:"Truffle"}),"\n",(0,a.jsxs)(t.p,{children:["Truffle is the framework that we have covered in the most depth so far in the course. Truffle will connect to a running blockchain specified in the truffle-config.js file, manage deployments via migration scripts and information stored in the truffle artifacts and abstracts away much of the complexity of interacting with contracts (via ",(0,a.jsx)(t.a,{href:"https://trufflesuite.com/docs/truffle/reference/contract-abstractions",children:"contract abstractions"}),")."]}),"\n",(0,a.jsx)(t.p,{children:"Other libraries handle these in different ways and have different APIs that are useful to review."}),"\n",(0,a.jsx)(t.h2,{id:"web3js",children:"Web3.js"}),"\n",(0,a.jsxs)(t.p,{children:["Web3.js is one of the most popular JavaScript libraries in Ethereum dApp development. It is currently maintained by Chainsafe, and you can visit ",(0,a.jsx)(t.a,{href:"https://github.com/ChainSafe/web3.js",children:"the Web3.js repository here."})]}),"\n",(0,a.jsxs)(t.p,{children:["Formerly, Web3.js was the library that Metamask would injected into your browser. If you had Metamask installed in your browser, you could see the web3 object by opening your browser developer tools. Since 2020, MetaMask has deprecated the injection of Web3.js into the browser and now simply uses window.ethereum. ",(0,a.jsx)(t.a,{href:"https://medium.com/metamask/breaking-changes-to-the-metamask-provider-are-here-7b11c9388be9",children:"Read more here."})]}),"\n",(0,a.jsx)(t.p,{children:"Since MetaMask does not inject it anymore, let's add it ourselves using the following steps:"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["Open your browser's developer console. ",(0,a.jsx)(t.a,{href:"https://support.happyfox.com/kb/article/882-accessing-the-browser-console-and-network-logs/",children:"See this article for how to do it"})," for major browsers in each major operating system."]}),"\n",(0,a.jsx)(t.li,{children:"In the Console, add the following series of Javascript code. Press enter after each line of code:"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"var script = document.createElement('script');\nscript.type = 'text/javascript';\nscript.src = 'script.js';\nscript.src = 'https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js';\ndocument.head.appendChild(script);\n"})}),"\n",(0,a.jsxs)(t.p,{children:["If this executed successfully, it will give us access to the ",(0,a.jsx)(t.code,{children:"web3"})," object. If you enter ",(0,a.jsx)(t.code,{children:"web3"})," into the console, you should see some auto-suggestions which means its available."]}),"\n",(0,a.jsx)(t.p,{children:"Now, we need to start up a local testnet using Ganache."}),"\n",(0,a.jsx)(t.h2,{id:"connect-to-ganache-gui",children:"Connect to Ganache GUI"}),"\n",(0,a.jsxs)(t.p,{children:["Let's connect to Ganache GUI. Start ",(0,a.jsx)(t.a,{href:"https://truffleframework.com/docs/ganache/overview",children:"Ganache GUI"})," and use the gear icon to change the Ganache port to ",(0,a.jsx)(t.code,{children:"8545"}),"."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"finding the gear in ganache GUI",src:n(9996).A+"",width:"1312",height:"912"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"changing the port number in ganache GUI",src:n(4823).A+"",width:"1312",height:"912"})}),"\n",(0,a.jsxs)(t.p,{children:["connect Metamask to ",(0,a.jsx)(t.code,{children:"Localhost 8545"})]}),"\n",(0,a.jsx)(t.h2,{id:"import-ganache-account-into-metamask",children:"Import Ganache Account into MetaMask"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"Note: These keys are not considered safe for production. You should not use them out in the wild!"})}),"\n",(0,a.jsx)(t.p,{children:'You can easily import Ganache GUI accounts into Metamask by importing via the private key. Click the key icon on the right side of Ganache GUI to get the associated account private key. To import the account into Metamask, select "Import Account" in the Metamask accounts dropdown, and paste in the private key.'}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.img,{src:"https://files.cdn.thinkific.com/file_uploads/205430/images/b32/51d/630/1595392067077.jpg",alt:""}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,a.jsx)(t.img,{src:"https://files.cdn.thinkific.com/file_uploads/205430/images/ba1/88e/3a1/1595392059006.jpg",alt:""})]}),"\n",(0,a.jsx)(t.p,{children:"Copy the public address of another address in your Ganache GUI. This is the address we'll send our transaction to!"}),"\n",(0,a.jsx)(t.h2,{id:"sending-the-transaction",children:"Sending the Transaction"}),"\n",(0,a.jsxs)(t.p,{children:["We need to connect our ",(0,a.jsx)(t.code,{children:"web3"})," object to our MetaMask account. We do that by running the following commands:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"ethereum.request({ method: 'eth_requestAccounts' })\n"})}),"\n",(0,a.jsx)(t.p,{children:'This should pop-up a MetaMask window asking you to connect to our website, please click "Confirm"'}),"\n",(0,a.jsxs)(t.p,{children:["Now that we have access to MetaMask, we can connect MetaMask to our ",(0,a.jsx)(t.code,{children:"web3"})," object by running the following:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"web3 = new Web3(window.ethereum)\n"})}),"\n",(0,a.jsx)(t.h3,{id:"checking-the-account",children:"Checking the account"}),"\n",(0,a.jsxs)(t.p,{children:["Once you are connected to Ganache GUI through Metamask, you can send transactions on the Ganache GUI network through the injected web3 object in the browser console. Typing ",(0,a.jsx)(t.code,{children:"web3.currentProvider.selectedAddress"})," should return your current account address."]}),"\n",(0,a.jsx)(t.h1,{id:"",children:(0,a.jsx)(t.img,{src:"https://files.cdn.thinkific.com/file_uploads/205430/images/1bc/2e0/b89/1595392059501.jpg",alt:""})}),"\n",(0,a.jsx)(t.h3,{id:"sending-a-transaction",children:"Sending a Transaction"}),"\n",(0,a.jsx)(t.p,{children:"Grab the second public address you copied earlier from your Ganache GUI. Use the following code snippet as your transaction information."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-var",metastring:"transaction = {",children:'from: web3.currentProvider.selectedAddress,\nto: "ENTER_SECOND_ADDRESS_HERE",\nvalue: web3.utils.toWei("0.001", "ether")\n}```\n\n\nTh "to" account is the second account that is generated by the Quickstart in Ganache GUI.\n\nNow sending a transaction is as easy as entering `ethereum.request({ method: \'eth_sendTransaction\', params: [transaction]})` in the console and Metamask will pop up, asking you to sign the transaction. If you get an error, you may need to reset the web3 provider. You can do that with this line of code `web3.setProvider(web3.currentProvider)`.\n\n![](https://files.cdn.thinkific.com/file_uploads/205430/images/9b8/1ea/5f4/1595392060592.jpg)\n\n### Nonce Mismatch Errors\n\nIf you use Metamask accounts on different development blockchains, the nonce counts may get out of sync, in which case you will see an error when trying to execute a transaction. Metamask tracks the account nonce independently so this can get out of sync with the account nonce on the blockchain network that you are trying to interact with.\n\n![](https://files.cdn.thinkific.com/file_uploads/205430/images/093/061/1f9/1595392063094.jpg)\n\nIf this happens, it is a simple fix. Open Metamask and click the account icon on the upper right and select "Settings". In the "Advanced" area, select "Reset Account".\xa0\n\n![](https://files.cdn.thinkific.com/file_uploads/205430/images/6e5/703/5bf/1595392061452.jpg)\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0![](https://files.cdn.thinkific.com/file_uploads/205430/images/e7a/aaa/8c7/1595392061366.jpg)\n\nIf you were seeing this error, reset your account and try sending the transaction again. Metamask will get the correct account nonce from the blockchain network. When the transaction succeeds, you should see the new account balances reflected on Ganache GUI.\n\nYou can check the balance of these accounts with the line `let balance = await ethereum.request({ method: \'eth_getBalance\', params:[web3.currentProvider.selectedAddress, "latest"]})`, this returns the account balance expressed in Wei in hexadecimal format and can be converted to ether like so `parseInt(balance) / 10**18`. \n\nThis is just a quick intro to sending transaction with web3.js v1.0\\. You can learn more about how to use it via the docs and specifically about [how to connect to a contract via this section.](https://web3js.readthedocs.io/en/1.0/web3-eth-contract.html#web3-eth-contract)\xa0\n\nKeep in mind that this library is still in development, so if you run into any bugs, please report them!\n\n## Ethers.js\n\nLet\'s try connecting to a different library, [the ethers.js library.](https://docs.ethers.io/v5/)\n\nWe\'ll have to follow the same steps to import it as above with Web3.js: \n\n'})}),"\n",(0,a.jsxs)(t.p,{children:["var script = document.createElement('script');\nscript.type = 'text/javascript';\nscript.src = 'script.js';\nscript.src = '",(0,a.jsx)(t.a,{href:"https://cdn.ethers.io/lib/ethers-5.1.umd.min.js",children:"https://cdn.ethers.io/lib/ethers-5.1.umd.min.js"}),"';\ndocument.head.appendChild(script);"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:'\n### Connect to the Web 3 provider\n\nIn the browser console, you can connect ethers.js to the current network by accessing the provider given by Metamask, then set it is as the "signer". \n\n\n```// A Web3Provider wraps a standard Web3 provider, which is\n// what Metamask injects as window.ethereum into each page\nconst provider = new ethers.providers.Web3Provider(window.ethereum)\n\nconst provider = new ethers.providers.Web3Provider(web3.currentProvider);\n\n// There is only ever up to one account in MetaMask exposed\nconst signer = provider.getSigner();```\n\n\nNow that Metamask is set as the signer, you can send a transaction. [Check the "signer" API of ethers.js to see how to send a transaction.](https://docs.ethers.io/v5/api/signer/#Signer) Something like "signer.sendTransaction(transaction)" should work, but what does a transaction look like in ethers.js?\n\n\n```{\n    // Required unless deploying a contract (in which case omit)\n    to: addressOrName,  // the target address or ENS name\n\n    // These are optional/meaningless for call and estimateGas\n    nonce: 0,           // the transaction nonce\n    gasLimit: 0,        // the maximum gas this transaction may spend\n    gasPrice: 0,        // the price (in wei) per unit of gas\n\n    // These are always optional (but for call, data is usually specified)\n    data: "0x",         // extra data for the transaction, or input for call\n    value: 0,           // the amount (in wei) this transaction is sending\n    chainId: 3          // the network ID; usually added by a signer\n}```\n\n\n[You can check the docs here.](https://docs.ethers.io/v5/api/providers/types/#providers-TransactionRequest)\n\nFor a simple ether transfer, you can get away with:\n\n\n```var transaction = {\n    to: "TO_ADDRESS_HERE",\n    value: ethers.utils.parseEther("1")\n}```\n\n\nAnd to send it, enter \xa0`signer.sendTransaction(transaction)` in the browser console.  \n\n![](https://files.cdn.thinkific.com/file_uploads/205430/images/298/fe3/19b/1595392061279.jpg)\n\nConfirm the transaction and verify that the account balances have changed in Ganache GUI.\n\n[Please explore the Ether.js documentation to see all of the things that it can do.](https://docs.ethers.io/v5/api/)\n\n## Summary\n\nAs a developer, you can use different JavaScript libraries to interact with Ethereum blockchains. Many of the JavaScript libraries do many of the same things, but they may handle transaction signers or providers differently or have different ways of connecting to contracts and listening to events. The library you choose is primarily a matter of personal preference.  \nWe focus on using web3.js in this course, but introduce ethers.js because it is a popular alternative.\n\n## Additional Material\n- [Article: Web3 vs ethers Part I](https://blog.infura.io/ethereum-javascript-libraries-web3-js-vs-ethers-js-part-i/) and [Part II](https://blog.infura.io/ethereum-javascript-libraries-web3-js-vs-ethers-js-part-ii/) by Academy\'s own Tom Hay and Robbie K.\n- [Course: Learn Ethers.js (Chainshot)](https://www.chainshot.com/learn/ethers) Use Chainshot\'s excellent interactive interface to learn more about ethers.js\n'})})]})}function l(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},9996:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/ganache-1-a34434499303cabfaec69b52255c83ae.png"},4823:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/ganache-2-6cab6e542a1022f9f28b9ca2aca88337.png"},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>r});var a=n(6540);const s={},o=a.createContext(s);function i(e){const t=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(o.Provider,{value:t},e.children)}}}]);