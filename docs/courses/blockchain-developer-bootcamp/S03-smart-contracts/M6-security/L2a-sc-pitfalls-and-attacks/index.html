<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Smart Contract Pitfalls and Attacks | Education DAO documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://education-dao-organization.github.io/educationdao.xyz/img/education-dao-animated-logo.svg"><meta data-rh="true" name="twitter:image" content="https://education-dao-organization.github.io/educationdao.xyz/img/education-dao-animated-logo.svg"><meta data-rh="true" property="og:url" content="https://education-dao-organization.github.io/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Smart Contract Pitfalls and Attacks | Education DAO documentation"><meta data-rh="true" name="description" content="Now that we&#x27;ve gone through some of the attack vectors in the language and syntax of Solidity, let&#x27;s move on to more general smart contract pitfalls and attacks. These are more general attack patterns which involve zooming out from a codeline level to a broader contract workflow view (Call Known Attacks). There are also concerns that come from a protocol level, which will require marrying the information we learned in the first few sections of the course with the smart contract knowledge you gained (Network Known Attacks)."><meta data-rh="true" property="og:description" content="Now that we&#x27;ve gone through some of the attack vectors in the language and syntax of Solidity, let&#x27;s move on to more general smart contract pitfalls and attacks. These are more general attack patterns which involve zooming out from a codeline level to a broader contract workflow view (Call Known Attacks). There are also concerns that come from a protocol level, which will require marrying the information we learned in the first few sections of the course with the smart contract knowledge you gained (Network Known Attacks)."><link data-rh="true" rel="icon" href="/educationdao.xyz/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://education-dao-organization.github.io/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/"><link data-rh="true" rel="alternate" href="https://education-dao-organization.github.io/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/" hreflang="en"><link data-rh="true" rel="alternate" href="https://education-dao-organization.github.io/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/educationdao.xyz/blog/rss.xml" title="Education DAO documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/educationdao.xyz/blog/atom.xml" title="Education DAO documentation Atom Feed"><link rel="stylesheet" href="/educationdao.xyz/assets/css/styles.ec88c8af.css">
<script src="/educationdao.xyz/assets/js/runtime~main.2a33aff0.js" defer="defer"></script>
<script src="/educationdao.xyz/assets/js/main.66f0d605.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/educationdao.xyz/"><div class="navbar__logo"><img src="/educationdao.xyz/img/logo.svg" alt="EducationDAO Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/educationdao.xyz/img/logo.svg" alt="EducationDAO Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">EducationDAO</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/educationdao.xyz/docs/archive/">Explore</a><a class="navbar__item navbar__link" href="/educationdao.xyz/blog">News</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Education-DAO-Organization/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/educationdao.xyz/docs/archive/">The Education DAO Archive</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/educationdao.xyz/docs/courses/">Courses</a><button aria-label="Collapse sidebar category &#x27;Courses&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/">The Blockchain Developer Bootcamp</a><button aria-label="Collapse sidebar category &#x27;The Blockchain Developer Bootcamp&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S00-intro/L1-course-intro/">S00-intro</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S01-fundamentals/M0-intro/">S01-fundamentals</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S02-ethereum/M1-background/">S02-ethereum</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M1-mental-model/L1-mental-model-sc/">S03-smart-contracts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M1-mental-model/L1-mental-model-sc/">M1-mental-model</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M2-intro-to-truffle/L1-background/">M2-intro-to-truffle</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M2-solidity/L1-background-context/">M2-solidity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M3-python/L1-background-and-context/">M3-python</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M4-design-patterns/L1-intro-smart-contracts/">M4-design-patterns</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M5-exercises/L1/">M5-exercises</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L1-sc-best-practices/">M6-security</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L1-sc-best-practices/">index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2-solidity-pitfalls-and-attacks/">Solidity Pitfalls and Attacks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/">Smart Contract Pitfalls and Attacks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2b-tx-origin-attack/">index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2c-dos-attack/">DoS Attack Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2d-reentrancy-attack/">Reentrancy Example</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2e-int-under-over-attack/">Integer Over / Underflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L3-sc-checklist/">index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L4-tdd-and-truffle-tests/">Title</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L5-intro-to-dili/">Security: Introduction to Diligence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L6-scribble/">index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L7-other-security-options/">index</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/V0-intro-to-remix/">index</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S04-developer-tooling/M1-intro/L1-users-in-mental-model/">S04-developer-tooling</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S05a-defi/M0-concepts/">S05a-defi</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S06-daos/M1-understand/">S06-daos</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S07-additional-topics/L1-ipfs/">S07-additional-topics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S08-scalability/M1-intro/L1-overview/">S08-scalability</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S09-beyond-code/M1-EIPs/">S09-beyond-code</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S10-eth2/M1-background/">S10-eth2</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S11-what-now/">Title</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S12-final-project/">Title</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/study-guides/en/chapter1-fundamentals-study-guide-suggestions">study-guides</a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/educationdao.xyz/docs/">index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/educationdao.xyz/docs/projects/">Projects</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/educationdao.xyz/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/educationdao.xyz/docs/courses/"><span itemprop="name">Courses</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/"><span itemprop="name">The Blockchain Developer Bootcamp</span></a><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">S03-smart-contracts</span><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">M6-security</span><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Smart Contract Pitfalls and Attacks</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Smart Contract Pitfalls and Attacks</h1>
<p>Now that we&#x27;ve gone through some of the attack vectors in the language and syntax of Solidity, let&#x27;s move on to more general smart contract pitfalls and attacks. These are more general attack patterns which involve zooming out from a codeline level to a broader contract workflow view (<em>Call Known Attacks</em>). There are also concerns that come from a protocol level, which will require marrying the information we learned in the first few sections of the course with the smart contract knowledge you gained (Network Known Attacks).</p>
<p>All these attack vectors (and more) are compiled in the Smart Contract Weakness Classification and Test Cases or <a href="https://swcregistry.io/" target="_blank" rel="noopener noreferrer">SWC Registry</a>, we&#x27;ll reference attack vectors by their SWC index number:</p>
<p>Network Known Attacks:</p>
<ul>
<li>Front-Running (<a href="https://swcregistry.io/docs/SWC-114" target="_blank" rel="noopener noreferrer">SWC-114</a>)</li>
<li>Timestamp Dependence (<a href="https://swcregistry.io/docs/SWC-116" target="_blank" rel="noopener noreferrer">SWC-116</a>)</li>
<li>Network Stuffing DoS</li>
</ul>
<p>Call Known Attacks:</p>
<ul>
<li>Forcibly Sending Ether (<a href="https://swcregistry.io/docs/SWC-132" target="_blank" rel="noopener noreferrer">SWC-132</a>)</li>
<li>Block Gas Limit DoS (<a href="https://swcregistry.io/docs/SWC-128" target="_blank" rel="noopener noreferrer">SWC-128</a>)</li>
<li>Reentrancy (<a href="https://swcregistry.io/docs/SWC-107" target="_blank" rel="noopener noreferrer">SWC-107</a>)</li>
<li>Integer Overflow/Underflow (<a href="https://swcregistry.io/docs/SWC-101" target="_blank" rel="noopener noreferrer">SWC-101</a>)</li>
<li>Unexpected Revert DoS (<a href="https://swcregistry.io/docs/SWC-113" target="_blank" rel="noopener noreferrer">SWC-113</a>)</li>
<li>Tx.Origin Authentication (<a href="https://swcregistry.io/docs/SWC-115" target="_blank" rel="noopener noreferrer">SWC-115</a>)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="frontrunning">Frontrunning<a class="hash-link" aria-label="Direct link to Frontrunning" title="Direct link to Frontrunning" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#frontrunning">​</a></h2>
<p><img decoding="async" loading="lazy" alt="front-running diagram" src="/educationdao.xyz/assets/images/swc-1-cfbd8469e848e7727a4a256f2d339310.png" width="512" height="234" class="img_ev3q"></p>
<p>Frontrunning has become a big issue in the Ethereum community as related to Miner-Extracted Value (MEV), which we discussed earlier. Frontrunning exploits how transactions are included in the blockchain and considerations around the process. Transactions that are broadcast to the network but have not yet been included in a block are in the mempool.</p>
<p>Miners choose the order in which to include transactions from the mempool into a block that they are mining. Also, since transactions are in the mempool before they make it into a block, anyone can know what transactions are about to occur on the network.</p>
<p>This can be problematic for things like decentralized markets.</p>
<p>Protecting against this is difficult and you will likely need to devise contract specific solutions.</p>
<p>Decentralized markets can mitigate concerns by implementing batch auctions or using a pre-commit scheme, where the details are submitted after the transaction is committed.</p>
<p>More information about Transaction Order Dependence and concrete samples are available in <a href="https://swcregistry.io/docs/SWC-114" target="_blank" rel="noopener noreferrer">the corresponding SWC Registry entry.</a> Due to the increased focus on MEV, we can expect to see a lot more security tips and research around frontrunning.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="timestamp-dependence">Timestamp Dependence<a class="hash-link" aria-label="Direct link to Timestamp Dependence" title="Direct link to Timestamp Dependence" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#timestamp-dependence">​</a></h2>
<p><img decoding="async" loading="lazy" alt="timestampe dependence" src="/educationdao.xyz/assets/images/swc-2-f5cd7cd330a454c46eb04ab656b86ad8.png" width="512" height="234" class="img_ev3q"></p>
<p>Contracts often need access to time values to perform certain types of functionality. Values such as block.timestamp, and block.number can give you a sense of the current time or a time delta, however, they are not safe to use for most purposes.</p>
<p>In the case of block.timestamp, developers often attempt to use it to trigger time-dependent events. As Ethereum is decentralized, nodes can synchronize time only to some degree. Moreover, malicious miners can alter the timestamp of their blocks, especially if they can gain advantages by doing so. (<a href="https://swcregistry.io/docs/SWC-116" target="_blank" rel="noopener noreferrer">source</a>)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="network-stuffing-dos">Network Stuffing DoS<a class="hash-link" aria-label="Direct link to Network Stuffing DoS" title="Direct link to Network Stuffing DoS" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#network-stuffing-dos">​</a></h2>
<p><img decoding="async" loading="lazy" alt="network stuffing image" src="/educationdao.xyz/assets/images/swc-3-46745706b573b0b1c8972e76fe232f6a.png" width="512" height="234" class="img_ev3q"></p>
<p>This is an attack vector based around time-sensitive operations, such as an auction or a time-locked wallet, or operations requiring user input before committing an irreversible action. Essentially, we need to guard against the fact that, particularly now, there can be moments of high-traffic (not even malicious) where it can be near-impossible to get one&#x27;s transactions to a smart contract. We hope with EIP-1559 these moments are short, but they may exist. As such, we need to make sure time-sensitive operations have some fallback or failsafe mechanism to guard against network stuffing, malicious or otherwise.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="forcibly-sending-ether">Forcibly Sending Ether<a class="hash-link" aria-label="Direct link to Forcibly Sending Ether" title="Direct link to Forcibly Sending Ether" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#forcibly-sending-ether">​</a></h2>
<p><img decoding="async" loading="lazy" alt="forcibly sending ether diagram" src="/educationdao.xyz/assets/images/swc-4-4cbab54fd55efb1aee26a5a1d89dcb02.png" width="512" height="234" class="img_ev3q"></p>
<p>Another danger is using logic that depends on the contract balance.</p>
<p>Be aware that it is possible to send ether to a contract without triggering its fallback function.</p>
<p>Using the selfdestruct function on another contract and using the target contract as the recipient will force the destroyed contract’s funds to be sent to the target.</p>
<p>It is also possible to pre-compute a contracts address and send ether to the address before the contract is deployed see (<a href="https://docs.openzeppelin.com/cli/2.8/deploying-with-create2" target="_blank" rel="noopener noreferrer">CREATE2</a>).</p>
<p>The contract’s balance will be greater than 0 when it is finally deployed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="block-gas-limit-dos">Block Gas Limit DoS<a class="hash-link" aria-label="Direct link to Block Gas Limit DoS" title="Direct link to Block Gas Limit DoS" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#block-gas-limit-dos">​</a></h2>
<p><img decoding="async" loading="lazy" alt="block gas limit dos diagram" src="/educationdao.xyz/assets/images/swc-5-59201e8fb72db22e04248e7e9c0278c6.png" width="512" height="234" class="img_ev3q"></p>
<p>There is a limit to how much computation can be included in a single Ethereum block, currently 10,000,000 gas worth. This means that if your smart contract reaches a state where a transaction requires more than 10,000,000 gas to execute, that transaction will never successfully execute (<a href="https://swcregistry.io/docs/SWC-128" target="_blank" rel="noopener noreferrer">SWC-128</a>). It will always reach the block gas limit before finishing.</p>
<p>Similarly, if the require gas for the transaction is sub 8,000,000, but close to it, you may have a harder time getting your transaction included in a block by a miner. It is more likely that if you send a transaction to the network with a startGas close to 8,000,000, a miner will not pick the transaction to include in a block. You can find more info about the default mining transaction ordering options in the most popular clients <a href="https://ethereum.stackexchange.com/questions/6107/what-is-the-default-ordering-of-transactions-during-mining-in-e-g-geth/6111#6111" target="_blank" rel="noopener noreferrer">here.</a></p>
<p>This situation becomes possible if your contract loops over an array of undetermined size. If the array becomes too large it may never execute. A concrete sample of a dynamic array potentially resulting in a denial of service is available at the <a href="https://swcregistry.io/docs/SWC-128" target="_blank" rel="noopener noreferrer">SWC Registry entry here.</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reentrancy">Reentrancy<a class="hash-link" aria-label="Direct link to Reentrancy" title="Direct link to Reentrancy" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#reentrancy">​</a></h2>
<p><img decoding="async" loading="lazy" alt="reentrancy attack diagram" src="/educationdao.xyz/assets/images/swc-6-32a4f18ccc2b54b71e1168f3cc8ed321.png" width="512" height="234" class="img_ev3q"></p>
<p>Reentrancy attacks (<a href="https://swcregistry.io/docs/SWC-107" target="_blank" rel="noopener noreferrer">SWC-107</a>) are very well-known thanks to the infamous DAO hack that happened on the Ethereum network. In a reentrancy attack, a vulnerable contract sends ether to an unknown address that contains a fallback function. Then, a malicious code calls back repeatedly a function in the vulnerable contract before the first call be finished.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Vulnerable contract</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function withdraw(uint _amount) public {    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  require(balances[msg.sender] &gt;= _amount, &quot;Not enough balance!&quot;);    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  msg.sender.call.value(_amount)(&quot;&quot;);    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  balances[msg.sender] -= _amount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Malicious contract</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function () payable external {    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(address(vulnerableContract).balance &gt; 1 ether) {        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vulnerableContract.withdraw(1 ether);    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you can’t remove the external call, the next simplest way to prevent this attack is to do the internal work before making the external function call.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mapping (address =&gt; uint) private userBalances; // Better!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function withdrawBalance() public {    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint amountToWithdraw = userBalances[msg.sender];    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  userBalances[msg.sender] = 0;    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // The user&#x27;s balance is already 0, so future invocations won&#x27;t withdraw anything</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  require(msg.sender.call.value(amountToWithdraw)()); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Or to use the withdrawal design pattern and separate the contract accounting logic and the transfer logic.</p>
<p>Another thing to be aware of is potential cross function re-entrancy. This can be problematic if your contract has multiple functions that modify the same state.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// INSECURE    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mapping (address =&gt; uint) private userBalances;        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function transfer(address to, uint amount) {        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (userBalances[msg.sender] &gt;= amount) {           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    userBalances[to] += amount;           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    userBalances[msg.sender] -= amount;        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function withdrawBalance() public {        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint amountToWithdraw = userBalances[msg.sender];   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // At this point, the caller&#x27;s code is executed, and can call transfer()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  require(msg.sender.call.value(amountToWithdraw)());         </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  userBalances[msg.sender] = 0;    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this case, the attacker can call transfer() when their code is executed on the external call in withdrawBalance. Since their balance has not yet been set to 0, they are able to transfer the tokens even though they already received the withdrawal. This vulnerability was also used in the DAO attack.</p>
<p>There are several ways to mitigate these problems.</p>
<p>The first is the Check-Effect-Interaction design pattern we described earlier. It is generally a good idea to handle the flow of a function like so:</p>
<ul>
<li><strong>Check</strong> Test condition. eg <code>require</code></li>
<li><strong>Effect</strong> Update state variable (eg update balance)</li>
<li><strong>Interaction</strong> Interact with external contract (eg send ether using <code>call.value</code>)</li>
</ul>
<p>In short, you handle your internal contract state changes before calling external contracts.</p>
<p>A more complex solution could implement mutual exclusion, or a <a href="https://en.wikipedia.org/wiki/Lock_(computer_science)" target="_blank" rel="noopener noreferrer">mutex.</a> This allows you to lock a state and only allow changes by the owner of the lock. You can see an example of a mutex in Solidity <a href="https://medium.com/coinmonks/protect-your-solidity-smart-contracts-from-reentrancy-attacks-9972c3af7c21" target="_blank" rel="noopener noreferrer">here.</a></p>
<p>You can dig deeper into known attacks such as these <a href="https://ethereum-contract-security-techniques-and-tips.readthedocs.io/en/latest/known_attacks/#race-conditions42" target="_blank" rel="noopener noreferrer">here.</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="integer-under--overflow">Integer Under / Overflow<a class="hash-link" aria-label="Direct link to Integer Under / Overflow" title="Direct link to Integer Under / Overflow" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#integer-under--overflow">​</a></h2>
<p><img decoding="async" loading="lazy" alt="integer under and overflow diagram" src="/educationdao.xyz/assets/images/swc-7-3a6a8e5ee313b8a1fc002be34b908d3b.png" width="512" height="234" class="img_ev3q"></p>
<p><strong>Note: With the inclusion of SafeMath natively with Solidity 0.8.x, the likelihood of writing an integer under / overflow is unlikely. However, this is still an issue that exists in the wild and there are edge cases in which it could be achieved.</strong></p>
<p>Integers can underflow or overflow in the EVM (<a href="https://swcregistry.io/docs/SWC-101" target="_blank" rel="noopener noreferrer">SWC-101</a>). This happens when an arithmetic value oversteps the minimum or maximum size of a type.</p>
<p>The max value for an unsigned integer is 2 ^ 256 - 1, which is roughly 1.15 times 10 ^ 77. If an integer overflows, the value will go back to 0. For example, a variable called score of type uint8 storing a value of 255 that is incremented by 1 will now be storing the value 0.</p>
<p>You may or may not have to worry about integer overflow depending on your smart contract.</p>
<p>A variable that can be set by user input may need to check against overflow, whereas it is infeasible that a variable that is incremented will ever approach this max value.</p>
<p>Underflow is a similar situation, but when a uint goes below its minimum value it will be set to its maximum value.</p>
<p>Be careful with smaller data types like uint8, uint16, etc… they can more easily reach their maximum value</p>
<p>More information and concrete examples can be found at <a href="https://swcregistry.io/docs/SWC-101" target="_blank" rel="noopener noreferrer">the corresponding SWC Registry entry</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="unexpected-revert-dos">Unexpected Revert DoS<a class="hash-link" aria-label="Direct link to Unexpected Revert DoS" title="Direct link to Unexpected Revert DoS" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#unexpected-revert-dos">​</a></h2>
<p>This attack basically consists of make a vulnerable contract inoperable by forcing a failure or an awaiting situation, locking temporarily or permanently the contract execution (<a href="https://swcregistry.io/docs/SWC-113" target="_blank" rel="noopener noreferrer">SWC-113</a>).</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// INSECURE  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract Auction {      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  address currentLeader;      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint highestBid;        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function bid() payable {          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    require(msg.value &gt; highestBid);            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Refund the old leader, if it fails then revert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    require(currentLeader.send(highestBid));             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    currentLeader = msg.sender;          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    highestBid = msg.value;      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the provided example, the <code>highestBidder</code> could be another contract and transferring funds to the contract triggers the contract’s fallback function. If the contract’s fallback always reverts, the <code>Auction</code> contract’s bid function becomes unusable - it will always revert. The bid function requires the transfer operation to succeed to fully execute.</p>
<p>The contract at the provided address throws an exception, execution halts and the exception is passed into the calling contract and prevents further execution.</p>
<p>This problem is avoidable using the withdrawal pattern and push-pull. You could also use a multisig contract, expire time or another technique as an emergency plan for possible lock situations.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="txorigin-authentication"><code>tx.origin</code> Authentication<a class="hash-link" aria-label="Direct link to txorigin-authentication" title="Direct link to txorigin-authentication" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#txorigin-authentication">​</a></h2>
<p><img decoding="async" loading="lazy" alt="tx.origin authentication diagram" src="/educationdao.xyz/assets/images/swc-9-621d0c00c0b7cdccd580d9c9df3bf9b3.png" width="512" height="234" class="img_ev3q"></p>
<p>This kind of attack happens when a vulnerable contract uses <code>tx.origin</code> for authentication. An attacker can induce the owner of the vulnerable contract make a call to a malicious contract. Then, a malicious code calls the vulnerable contract, taking advantage of the owner authorizations.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Vulnerable contract  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function withdraw(address payable _recipient) public {      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  require(tx.origin == owner);      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _recipient.transfer(address(this).balance);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Malicious contract  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function() external payable {      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  vulnerableContract.withdraw(attackerAddress);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>An example of this was the <a href="https://twitter.com/kelvinfichter/status/1425217046636371969" target="_blank" rel="noopener noreferrer">Poly Network hack,</a> although not on the Ethereum network.</p>
<p>There are always more attack vectors, be sure to look through the SWC registry,  <a href="https://twitter.com/ConsenSysAudits" target="_blank" rel="noopener noreferrer">follow Diligence on Twitter</a>, or whatever source you need to make sure you stay up to date with security on Ethereum.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="additional-material">Additional Material<a class="hash-link" aria-label="Direct link to Additional Material" title="Direct link to Additional Material" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#additional-material">​</a></h2>
<ul>
<li><a href="https://consensys.github.io/smart-contract-best-practices/" target="_blank" rel="noopener noreferrer">Wiki: Smart Contract Best Practices</a> and <a href="https://ethereum-contract-security-techniques-and-tips.readthedocs.io/en/latest/recommendations/" target="_blank" rel="noopener noreferrer">Recommendations</a></li>
<li><a href="https://medium.com/@danrobinson/ethereum-is-a-dark-forest-ecc5f0505dff" target="_blank" rel="noopener noreferrer">Article: Ethereum is a Dark Forest</a> A long, comprehensive article discussing frontrunning from a first-person perspective. Got a lot of people&#x27;s attention in the community around the topic.</li>
<li><a href="https://github.com/flashbots/pm" target="_blank" rel="noopener noreferrer">Wiki: Flashbots</a> A collection of research and news about Miner Extracted Value and Frontrunning.</li>
<li><a href="https://sunnya97.gitbooks.io/a-beginner-s-guide-to-ethereum-and-dapp-developme/smart-contract-best-practices.html" target="_blank" rel="noopener noreferrer">Article: Smart Contract Bugs and Security Best Practices</a></li>
<li><a href="http://hackingdistributed.com/2017/08/28/submarine-sends/" target="_blank" rel="noopener noreferrer">Article: To Sink Frontrunners, Send in the Submarines</a> An article discussing a frontrunning defense mechanism</li>
<li><a href="https://medium.com/coinmonks/protect-your-solidity-smart-contracts-from-reentrancy-attacks-9972c3af7c21" target="_blank" rel="noopener noreferrer">Article: Protect Your Solidity Smart Contracts from Reentrancy</a> Discusses mutex locks in Solidity.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-07-15T16:44:56.000Z" itemprop="dateModified">Jul 15, 2024</time></b> by <b>oliver renwick</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2-solidity-pitfalls-and-attacks/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Solidity Pitfalls and Attacks</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2b-tx-origin-attack/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">index</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#frontrunning">Frontrunning</a></li><li><a class="table-of-contents__link toc-highlight" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#timestamp-dependence">Timestamp Dependence</a></li><li><a class="table-of-contents__link toc-highlight" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#network-stuffing-dos">Network Stuffing DoS</a></li><li><a class="table-of-contents__link toc-highlight" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#forcibly-sending-ether">Forcibly Sending Ether</a></li><li><a class="table-of-contents__link toc-highlight" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#block-gas-limit-dos">Block Gas Limit DoS</a></li><li><a class="table-of-contents__link toc-highlight" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#reentrancy">Reentrancy</a></li><li><a class="table-of-contents__link toc-highlight" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#integer-under--overflow">Integer Under / Overflow</a></li><li><a class="table-of-contents__link toc-highlight" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#unexpected-revert-dos">Unexpected Revert DoS</a></li><li><a class="table-of-contents__link toc-highlight" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#txorigin-authentication"><code>tx.origin</code> Authentication</a></li><li><a class="table-of-contents__link toc-highlight" href="/educationdao.xyz/docs/courses/blockchain-developer-bootcamp/S03-smart-contracts/M6-security/L2a-sc-pitfalls-and-attacks/#additional-material">Additional Material</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/educationdao.xyz/docs/projects">Projects</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/24Nqz6zP" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://hey.xyz/u/educationdao" target="_blank" rel="noopener noreferrer" class="footer__link-item">Lens Protocol<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://warpcast.com/educationdao" target="_blank" rel="noopener noreferrer" class="footer__link-item">Farcaster<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/Education__DAO" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/educationdao.xyz/blog">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Education DAO.</div></div></div></footer></div>
</body>
</html>